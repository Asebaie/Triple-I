2025-12-26 21:53:08,771 | Начало процесса обучения автоэнкодера с Optuna
2025-12-26 21:53:08,772 | Загрузка и предварительная обработка данных
2025-12-26 21:53:08,772 | Парсинг training set
2025-12-26 21:53:08,772 | Чтение archive/combined_data_1.txt
2025-12-26 21:53:30,713 | Чтение archive/combined_data_2.txt
2025-12-26 21:54:16,896 | Чтение archive/combined_data_3.txt
2025-12-26 21:55:29,358 | Чтение archive/combined_data_4.txt
2025-12-26 22:04:06,061 | Загружено 100480507 оценок
2025-12-26 22:04:06,081 | Подвыборка данных: первые 10000 пользователей
2025-12-26 22:09:45,018 | После подвыборки: 15491807 оценок, пользователей: 10000
2025-12-26 22:09:45,341 | Пользователей: 10000 | Фильмов: 17770
2025-12-26 22:09:45,341 | Создание sparse матрицы
2025-12-26 22:09:45,527 | Нормализация (вычитание среднего пользователя)
2025-12-26 22:10:24,007 | Разделение данных на train/val
2025-12-26 22:10:24,522 | Создание DataLoader'ов
2025-12-26 22:10:24,923 | Используется устройство: cpu
2025-12-26 22:10:24,923 | Запуск оптимизации гиперпараметров с Optuna
2025-12-26 22:35:07,395 | Лучшие гиперпараметры: {'hidden_1': 426, 'hidden_2': 199, 'lr': 0.0002607440032537656, 'weight_decay': 0.00018456597068929628, 'epochs': 39}
2025-12-26 22:35:07,397 | Лучший Val RMSE: 0.717103
2025-12-26 22:35:07,397 | Обучение финальной модели с лучшими гиперпараметрами на всем train-наборе
2025-12-26 22:35:10,008 | Epoch [1/39], Train MSE: 3.685011, Val RMSE: 0.866350, Best Val RMSE: 0.866350
2025-12-26 22:35:12,566 | Epoch [2/39], Train MSE: 0.685599, Val RMSE: 0.823277, Best Val RMSE: 0.823277
2025-12-26 22:35:15,097 | Epoch [3/39], Train MSE: 0.666233, Val RMSE: 0.821727, Best Val RMSE: 0.821727
2025-12-26 22:35:17,602 | Epoch [4/39], Train MSE: 0.663216, Val RMSE: 0.822987, Best Val RMSE: 0.821727
2025-12-26 22:35:20,049 | Epoch [5/39], Train MSE: 0.661819, Val RMSE: 0.819863, Best Val RMSE: 0.819863
2025-12-26 22:35:22,527 | Epoch [6/39], Train MSE: 0.656252, Val RMSE: 0.810385, Best Val RMSE: 0.810385
2025-12-26 22:35:25,003 | Epoch [7/39], Train MSE: 0.632772, Val RMSE: 0.796471, Best Val RMSE: 0.796471
2025-12-26 22:35:27,471 | Epoch [8/39], Train MSE: 0.622143, Val RMSE: 0.794270, Best Val RMSE: 0.794270
2025-12-26 22:35:29,930 | Epoch [9/39], Train MSE: 0.623536, Val RMSE: 0.794331, Best Val RMSE: 0.794270
2025-12-26 22:35:32,402 | Epoch [10/39], Train MSE: 0.616897, Val RMSE: 0.787174, Best Val RMSE: 0.787174
2025-12-26 22:35:34,898 | Epoch [11/39], Train MSE: 0.599270, Val RMSE: 0.773308, Best Val RMSE: 0.773308
2025-12-26 22:35:37,326 | Epoch [12/39], Train MSE: 0.581235, Val RMSE: 0.766838, Best Val RMSE: 0.766838
2025-12-26 22:35:39,755 | Epoch [13/39], Train MSE: 0.574461, Val RMSE: 0.760477, Best Val RMSE: 0.760477
2025-12-26 22:35:42,186 | Epoch [14/39], Train MSE: 0.562729, Val RMSE: 0.754105, Best Val RMSE: 0.754105
2025-12-26 22:35:44,660 | Epoch [15/39], Train MSE: 0.556196, Val RMSE: 0.749578, Best Val RMSE: 0.749578
2025-12-26 22:35:47,078 | Epoch [16/39], Train MSE: 0.550337, Val RMSE: 0.746631, Best Val RMSE: 0.746631
2025-12-26 22:35:49,501 | Epoch [17/39], Train MSE: 0.547107, Val RMSE: 0.745101, Best Val RMSE: 0.745101
2025-12-26 22:35:51,914 | Epoch [18/39], Train MSE: 0.547581, Val RMSE: 0.745498, Best Val RMSE: 0.745101
2025-12-26 22:35:54,379 | Epoch [19/39], Train MSE: 0.543457, Val RMSE: 0.741138, Best Val RMSE: 0.741138
2025-12-26 22:35:56,880 | Epoch [20/39], Train MSE: 0.538965, Val RMSE: 0.739320, Best Val RMSE: 0.739320
2025-12-26 22:35:59,312 | Epoch [21/39], Train MSE: 0.537876, Val RMSE: 0.738172, Best Val RMSE: 0.738172
2025-12-26 22:36:01,745 | Epoch [22/39], Train MSE: 0.535260, Val RMSE: 0.736390, Best Val RMSE: 0.736390
2025-12-26 22:36:04,184 | Epoch [23/39], Train MSE: 0.531855, Val RMSE: 0.734160, Best Val RMSE: 0.734160
2025-12-26 22:36:06,632 | Epoch [24/39], Train MSE: 0.531014, Val RMSE: 0.731972, Best Val RMSE: 0.731972
2025-12-26 22:36:09,061 | Epoch [25/39], Train MSE: 0.525720, Val RMSE: 0.729839, Best Val RMSE: 0.729839
2025-12-26 22:36:11,518 | Epoch [26/39], Train MSE: 0.522953, Val RMSE: 0.728103, Best Val RMSE: 0.728103
2025-12-26 22:36:13,980 | Epoch [27/39], Train MSE: 0.519247, Val RMSE: 0.726960, Best Val RMSE: 0.726960
2025-12-26 22:36:16,415 | Epoch [28/39], Train MSE: 0.519146, Val RMSE: 0.725767, Best Val RMSE: 0.725767
2025-12-26 22:36:18,836 | Epoch [29/39], Train MSE: 0.516822, Val RMSE: 0.724649, Best Val RMSE: 0.724649
2025-12-26 22:36:21,301 | Epoch [30/39], Train MSE: 0.517689, Val RMSE: 0.723833, Best Val RMSE: 0.723833
2025-12-26 22:36:23,763 | Epoch [31/39], Train MSE: 0.517011, Val RMSE: 0.723182, Best Val RMSE: 0.723182
2025-12-26 22:36:26,215 | Epoch [32/39], Train MSE: 0.512059, Val RMSE: 0.721000, Best Val RMSE: 0.721000
2025-12-26 22:36:28,651 | Epoch [33/39], Train MSE: 0.514165, Val RMSE: 0.721016, Best Val RMSE: 0.721000
2025-12-26 22:36:31,067 | Epoch [34/39], Train MSE: 0.510655, Val RMSE: 0.720184, Best Val RMSE: 0.720184
2025-12-26 22:36:33,537 | Epoch [35/39], Train MSE: 0.508914, Val RMSE: 0.719209, Best Val RMSE: 0.719209
2025-12-26 22:36:36,025 | Epoch [36/39], Train MSE: 0.507665, Val RMSE: 0.718615, Best Val RMSE: 0.718615
2025-12-26 22:36:38,474 | Epoch [37/39], Train MSE: 0.507258, Val RMSE: 0.718310, Best Val RMSE: 0.718310
2025-12-26 22:36:40,932 | Epoch [38/39], Train MSE: 0.506160, Val RMSE: 0.717591, Best Val RMSE: 0.717591
2025-12-26 22:36:43,401 | Epoch [39/39], Train MSE: 0.505195, Val RMSE: 0.716842, Best Val RMSE: 0.716842
2025-12-26 22:36:43,605 | Финальная модель сохранена в artifacts/ae_model_bundle_optuna.pkl
2025-12-26 22:36:43,606 | Отчет сохранен в artifacts/report_optuna.txt
2025-12-26 22:36:43,606 | Обучение завершено.
